<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>Welcome to the /usr/sbin/ece-install Guide</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2011-08-24 14:06:34 CST"/>
<meta name="author" content="Torstein Krause Johansen"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style> <link rel="stylesheet" type="text/css" href="vizrt-header.css"/>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>
<div id="content">

<svg
        id="vizrt-logo"
        version="1.1"
        width="138"
        height="84"
        > 
  <g
          id="g12"
          transform="matrix(1.25,0,0,-1.25,-451.34003,425.24315)"> 
    <g
            id="g14"
            transform="matrix(0.0246257,0,0,0.02458666,313.76213,231.21317)"> 
      <path
              d="m 3060.56,3437.2 -209.9,-593.4 -207.05,593.4 -215.82,0 326.08,-866.38 184.92,0 332.24,866.38 -210.47,0"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path16"/> 
      <path
              d="m 3473.3,2569.82 193.547,0 0,866.531 -193.547,0 0,-866.531 z"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path18"/> 
      <path
              d="m 3916.16,3436.36 -0.14,-177.24 364.23,0 -372.91,-554.74 0,-133.56 616.08,0 0,175.25 -374.66,0 366.68,550.78 0,139.51 -599.28,0"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path20"/> 
      <path
              d="m 4961.8,3436.66 c -56.15,0 -99.9,-9.02 -144.01,-53.04 -42.13,-42.13 -63.55,-93.63 -63.55,-153.7 l 0,-658.85 193.26,0 0,629.18 c 0,16.39 5.76,30.04 17.53,41.82 9.79,9.87 32.16,17.44 52.18,17.44 l 161.49,0 0,177.15 -216.9,0"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path22"/> 
      <path
              d="m 5367.91,3699.54 0,-915.91 c 0,-58.68 20.75,-109.43 62.13,-150.8 43.31,-43.47 85.57,-62.01 141.03,-62.01 l 212.69,0 0,174.7 -158.78,0 c -15.96,0 -28.96,5.5 -40.72,16.87 -11.19,11.53 -16.76,24.5 -16.76,40.65 l 0,456.42 216.26,0 0,176.39 -216.26,0 0,263.69 -199.59,0"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path24"/> 
      <path
              d="m 1921.16,3066.86 c -0.39,-514.15 173.24,-988.49 465.56,-1367.51 l 69.26,204.63 c -205.49,300.61 -333.44,658.06 -355.3,1043.68 l -179.52,119.2"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path26"/> 
      <path
              d="m 6404.28,3065.28 c 0.49,513.97 -173.17,988.55 -465.37,1367.26 l -69.46,-204.34 c 205.52,-300.7 333.61,-658.34 355.24,-1043.68 l 179.59,-119.24"
              style="fill:#f57615;fill-opacity:1;fill-rule:evenodd;stroke:none"
              id="path28"/> 
 
    </g> 
  </g> 
</svg>
<h1>Welcome to the /usr/sbin/ece-install Guide</h1>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1 Supported operating systems </a>
<ul>
<li>
<ul>
<li><a href="#sec-1-1">1.1 Debian based operating systems </a></li>
<li><a href="#sec-1-2">1.2 Other GNU/Linux and Unix systems </a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-2">2 A note on running ece-install on non-GNU/Linux systems </a></li>
<li><a href="#sec-3">3 You must run the script as root </a></li>
<li><a href="#sec-4">4 Running more than one installation process </a></li>
<li><a href="#sec-5">5 Available server profiles </a>
<ul>
<li><a href="#sec-5-1">5.1 Common for editorial, presentation and search instances </a></li>
<li><a href="#sec-5-2">5.2 1 - Full stack on one host </a></li>
<li><a href="#sec-5-3">5.3 2 - Editorial server (publication server) </a></li>
<li><a href="#sec-5-4">5.4 3 - Presentation server </a></li>
<li><a href="#sec-5-5">5.5 4 - Database server </a></li>
<li><a href="#sec-5-6">5.6 5 - Cache server </a></li>
<li><a href="#sec-5-7">5.7 8 - Install Widget Framework </a></li>
</ul>
</li>
<li><a href="#sec-6">6 Uninstalling everything that the ece-install set up </a>
<ul>
<li><a href="#sec-6-1">6.1 9 - Create Publication </a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Supported operating systems </h2>
<div class="outline-text-2" id="text-1">

<p>For the best experience, run this script on Debian Squeeze (or newer),
the latest Ubuntu LTS or most other Debian based operating systems,
but it should work without any problems on any Unix like system that
has a recent version of BASH.
</p>

</div>

<div id="outline-container-1-1" class="outline-4">
<h4 id="sec-1-1"><span class="section-number-4">1.1</span> Debian based operating systems </h4>
<div class="outline-text-4" id="text-1-1">

<p>If running on a Debian based operating system, ece-install will take
care of installing all required third party software, such as database
&amp; caching server.
</p>
</div>

</div>

<div id="outline-container-1-2" class="outline-4">
<h4 id="sec-1-2"><span class="section-number-4">1.2</span> Other GNU/Linux and Unix systems </h4>
<div class="outline-text-4" id="text-1-2">

<p>If you're installing on another Linux or Unix system, you must first
make sure that these 3rd party components are installed. ece-install
will tell you which ones it cannot find and tell you to install these,
so you can simply run it to find out which ones you need.
</p>
<p>
You may also look inside the ece-install script for all calls to the
'assert<sub>pre</sub><sub>prequesite'</sub> method and you'll get a list of the binaries
ece-install assumes are present.
</p>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> A note on running ece-install on non-GNU/Linux systems </h2>
<div class="outline-text-2" id="text-2">

<p>Please note, it's assumed that the OS uses GNU's tools, i.e. find, cp
&amp; tar. If you're running a system which has a different set of core
tools, such as any of the BSDs (including Mac OS X) or Solaris, make
sure that GNU's tools take precedence in the command PATH offered to
ece-install.
</p>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> You must run the script as root </h2>
<div class="outline-text-2" id="text-3">

<p>If you start the script as a regular user, it will complain:
</p>


<pre class="example">[ece-install] You must be root when running ece-install

</pre>



<p>
To become root on Ubuntu based systems and Mac OS X, do:
</p>


<pre class="example">$ sudo su

</pre>



<p>
On all other Unix like system, do:
</p>


<pre class="example">$ su

</pre>



</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Running more than one installation process </h2>
<div class="outline-text-2" id="text-4">

<p>If the script believes there's already an ece-intall process running,
it will abort:
</p>


<pre class="example">[ece-install] There's already one ece-install process running. If you believe
[ece-install] this is wrong, e.g. if a previous run of ece-install was aborted
[ece-install] before it completed, you may delete /var/run/ece-install.pid and
[ece-install] run ece-install again.

</pre>




</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Available server profiles </h2>
<div class="outline-text-2" id="text-5">

<p>When starting the script, it will ask you which server profile you
want to install:
</p>


<pre class="example">Hi, which server profile do you wish to install?

Select 1-7 and press ENTER

  1 - The full stack on one host. Suitable for development and
      test environments (cache, ECE, assembly host &amp; database).
  2 - Editorial (publication) server (ECE, assembly host).
  3 - Presentation server (ECE, memcached).
  4 - Database server.
  5 - Cache server (cache &amp; web server).
  6 - RMI hub.
  7 - Standalone search instance (solr + indexer-webapp).
  8 - Install Widget Framework. This will also set up a WF based 
      publication for you (repo.escenic.com user/pass required).

</pre>




</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> Common for editorial, presentation and search instances </h3>
<div class="outline-text-3" id="text-5-1">

<ul>
<li>Sun Java 6
</li>
<li>Apache Tomcat application server:
<ul>
<li>Compression of textual content (previously, this was typically set
    up with Apache and its mod<sub>deflate</sub> module).
</li>
<li>pooling set up tweaked for high read/write performance.
</li>
<li>proper logging configuration directing solr messages to its own log.
</li>
<li>routing information in the cookies
</li>
<li>access log

</li>
</ul>

</li>
<li>APR, native library for optimal Tomcat I/O performance
</li>
<li>Escenic Assembly environment
</li>
<li>Database driver

</li>
<li>Compression of content (what was previously accomplished with
  Apache/mod<sub>deflate</sub>) 
</li>
</ul>


</div>

</div>

<div id="outline-container-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> 1 - Full stack on one host </h3>
<div class="outline-text-3" id="text-5-2">

<p>This profile is suitable for developers and admins wanting to set up a
test environment. It will install the full stack including caching
server, application server, ECE, assembly host, database, Widget
Framework, as well as creating a publication for you.
</p>
<p>
For further details on each of the different server components, see
the different profile descriptions bellow.
</p>

</div>

</div>

<div id="outline-container-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> 2 - Editorial server (publication server) </h3>
<div class="outline-text-3" id="text-5-3">



</div>

</div>

<div id="outline-container-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> 3 - Presentation server </h3>
<div class="outline-text-3" id="text-5-4">

<p>This will set up a typical presentation server:
</p><ul>
<li>Memcached, distributed memory cache
</li>
<li>Escenic Assembly environment (which may be removed after the
  installation). 
</li>
<li>Deployment setup to only deploy escenic-admin and the
  publication(s).
</li>
</ul>


</div>

</div>

<div id="outline-container-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> 4 - Database server </h3>
<div class="outline-text-3" id="text-5-5">

<p>If ece-install is run on a support version of Debian or Ubuntu, this
will install the excellent Percona distribution of MySQL with their
set of high performance patches.
</p>
<p>
If not, MySQL or Percona must be installed in advance.
</p>
<p>
Given that the mysqld is install, this profile will download all the
Escenic components and install the ECE database schema based from the
SQL files contained inside the distribution bundles. To accomplish
this, the script will make a call to drop-and-create-ecedb in the same
directory as the ece-intall script itself.
</p>
<p>
If you wish to change the DB's host, user or password, you must update
the drop-and-create-ecedb script prior to running ece-install. 
</p>
</div>

</div>

<div id="outline-container-5-6" class="outline-3">
<h3 id="sec-5-6"><span class="section-number-3">5.6</span> 5 - Cache server </h3>
<div class="outline-text-3" id="text-5-6">

<p>If ece-install is run on a support version of Debian or Ubuntu, it
will install the latest Varnish 3.0 caching server from the Varnish
APT repository.
</p>
<p>
If ece-install is run on a different platform, the admin must install
Varnish 3.x prior to running ece-install.
</p>
<p>
The script will configure Varnish for a typical Escenic site:
</p><ul>
<li>will set up an access control lists of IPs which may access the
  privileged web applications such as /escenic-admin, /escenic and
  /webservice.

<p>
  ece-install will also add the host from which you connect, making
  sure that if you've SSH-ed into the server to conduct the install,
  you'll automatically be included in the "staff" ACL and can access
  all the web applications without editing these ACLs (or disabling
  security as many does).
</p>
</li>
<li>will set up sticky sessions/session binding
</li>
<li>will set up a backend cluster and allow the user to enter the
  different backend servers that will serve the web site.
</li>
<li>will set up configuration to strip away cookies from static
  resources, such as CSS, JS and pictures.
</li>
</ul>


<p>
TBD:
</p><ul>
<li>If run on a Linux platform, the script will tweak the kernel
  parameters for optimal TCP handling for a web facing server.
</li>
<li>Will install the nginx web server for serving static content and
  will configure Varnish accordingly. This will be very useful for
  Adactus servers wanting to pull content from your ECEs.
</li>
</ul>


</div>

</div>

<div id="outline-container-5-7" class="outline-3">
<h3 id="sec-5-7"><span class="section-number-3">5.7</span> 8 - Install Widget Framework </h3>
<div class="outline-text-3" id="text-5-7">

<p>You'll need a user name and password for accessing the
repo.escenic.com Maven repository. You should get these credentials
when you bought Widget Framework. If you for some reason do not have
these, please contact support@escenic.com. 
</p>
<p>
If you don't have these ready in your .escenicrc, ece-install will
complain:
</p>


<pre class="example">[ece-install] Be sure to set wf_user and wf_password in /root/.escenicrc
[ece-install] If you don't have these, please contact support@escenic.com

</pre>



</div>
</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Uninstalling everything that the ece-install set up </h2>
<div class="outline-text-2" id="text-6">

<p>WARNING: this is potentially dangerous as some of these components may
be used by other pieces of software you have running on your
host. However, this may be useful if you're installing a clean
environment and want to e.g. undo your previous install to install a
different profile.
</p>
<p>
Open the ece-install script and look for the "un<sub>install</sub><sub>ece</sub>"
function, it has copy and pastable commands for undoing most/all
things set up by the script.
</p>

</div>

<div id="outline-container-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> 9 - Create Publication </h3>
<div class="outline-text-3" id="text-6-1">

<p>This profile will create a publication for you, only asking you the
name of the publication and which ECE instance to use for its
creation.
</p>
<p>
This installation profile will base the publication on the Widget
Framework if its present on the system, if not, ECE's clean demo WAR
is used as a basis.  
</p></div>
</div>
</div>
<div id="postamble">
<p class="date">Date: 2011-08-24 14:06:34 CST</p>
<p class="author">Author: Torstein Krause Johansen</p>
<p class="creator">Org version 7.6 with Emacs version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>
</div>
</div>
</body>
</html>
