** Changing the DB Virtual IP

In your habitat, DB clients, such as the ECEs, use the database using
the <%= my-db-vip %> virtual IP (VIP). Whenever you change the master,
as described in [[Changing the Master DB]], you must also change the VIP
that the clients of the DB use.

We have deliberately _not_ set this up as an automatic failover using
[[http://linux-ha.org][Heartbeat]] as we want DB failover to be a conscious matter.

*** Take down the existing VIP
If <%= my-db-master %> is still up, log on to it and take down the
VIP:
#+BEGIN_SRC text
$ ssh root@<%= my-db-master %>
# ifdown <%= my-db-vip-interface %>
#+END_SRC

*** Set up the VIP interface on <%= my-db-slave %>
You're now ready to set up the VIP on <%= my-db-slave %>. You may want
to ensure that there's no one acclaiming the IP, do:
#+BEGIN_SRC text
$ ping <%= my-db-vip %>
#+END_SRC

If no one answers, you can go ahead and set it up:
#+BEGIN_SRC text
$ ssh root@<%= my-db-slave %>
# ifconfig eth0:0 <%= my-db-vip-ip %> <%= my-db-vip-netmask %> up
#+END_SRC



